			
						
						
						 // wczytanie listy kalkulacji
        public void WczytajListeKalkulacji()
        {
                ListaKalkulacji.Items.Clear();

                Database db = new Database();
                db.ExecQuery("Kalkulacja_Naglowki_Wczytaj_Liste");
                db.AddQueryParam("id_wyrob", file.ID);
                while (db.GetNextRow())
                {
                    int user_id = 0;
                    string zatwierdzil = "";

                    Int32.TryParse(db.ReadVariable("id_zatwierdzil").ToString(), out user_id);

                    if (user_id > 0)
                    {
                        IEdmUserMgr7 uMgr;
                        uMgr = (IEdmUserMgr7)vault.CreateUtility(EdmUtility.EdmUtil_UserMgr);
                        IEdmUser5 user = uMgr.GetUser(user_id);
                        IEdmUser6 user2 = (IEdmUser6)user;
                        zatwierdzil = user2.FullName;
                    }

                    string data = db.ReadVariable("data_zatwierdzenia").ToString();
                    if (data.Length > 10)
                    {
                        data = data.Substring(0, 10);
                    }

                    ListViewItem listItem = new ListViewItem(db.ReadVariable("id_kalkulacja").ToString());
                    listItem.SubItems.Add(db.ReadVariable("nazwa_kalkulacji").ToString());
                    listItem.SubItems.Add(db.ReadVariable("rewizja").ToString());
                    listItem.SubItems.Add(zatwierdzil);
                    listItem.SubItems.Add(data);
                    ListaKalkulacji.Items.AddRange(new ListViewItem[] { listItem });
                }

                foreach (ColumnHeader column in ListaKalkulacji.Columns)
                {
                    column.Width = -2;
                }
        }
		
		                Database db = new Database();
                        db.ExecQuery("Kalkulacja_Kopiuj");
                        db.AddQueryParam("id_wyrob", file.ID);
                        db.AddQueryParam("id_kalkulacja", id_kalkulacja);
                        db.AddQueryParam("id_utworzyl", PobierzUserID());
                        db.ConfirmQuery();